{"ast":null,"code":"import _regeneratorRuntime from \"/Users/kkalwik/Desktop/test/fix-praca-inz/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/kkalwik/Desktop/test/fix-praca-inz/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { createSlice } from '@reduxjs/toolkit';\nimport { fileAPI } from '../api/file-api';\nvar fileReducer = createSlice({\n  name: 'files',\n  initialState: {\n    files: [],\n    currentDir: null,\n    fileStack: [],\n    mode: 'list',\n    loading: false\n  },\n  reducers: {\n    setFiles: function setFiles(state, action) {\n      state.files = action.payload;\n    },\n    setCurrentDir: function setCurrentDir(state, action) {\n      state.currentDir = action.payload;\n    },\n    createFile: function createFile(state, action) {\n      state.files.push(action.payload);\n    },\n    removeFile: function removeFile(state, action) {\n      state.files = state.files.filter(function (file) {\n        return file._id !== action.payload.id;\n      });\n    },\n    pushToFileStack: function pushToFileStack(state, action) {\n      state.fileStack.push(action.payload);\n    },\n    popFromFileStack: function popFromFileStack(state, action) {\n      state.fileStack.pop();\n    },\n    setFileViewMode: function setFileViewMode(state, action) {\n      state.mode = action.payload;\n    },\n    toggleLoading: function toggleLoading(state, action) {\n      state.loading = action.payload;\n    }\n  }\n});\nvar _fileReducer$actions = fileReducer.actions,\n    setFiles = _fileReducer$actions.setFiles,\n    setCurrentDir = _fileReducer$actions.setCurrentDir,\n    createFile = _fileReducer$actions.createFile,\n    removeFile = _fileReducer$actions.removeFile,\n    pushToFileStack = _fileReducer$actions.pushToFileStack,\n    popFromFileStack = _fileReducer$actions.popFromFileStack,\n    setFileViewMode = _fileReducer$actions.setFileViewMode,\n    toggleLoading = _fileReducer$actions.toggleLoading;\nexport { setFiles, setCurrentDir, createFile, removeFile, pushToFileStack, popFromFileStack, setFileViewMode, toggleLoading };\nexport default fileReducer.reducer;\nexport var loadFiles = function loadFiles(dirId, sort) {\n  return /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch) {\n      var data;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return fileAPI.getFiles(dirId, sort);\n\n            case 2:\n              data = _context.sent;\n              dispatch(setFiles(data));\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n};\nexport var createNewDir = function createNewDir(dirId, name) {\n  return /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch) {\n      var dir;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return fileAPI.createDir(dirId, name);\n\n            case 2:\n              dir = _context2.sent;\n              dispatch(createFile(dir));\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function (_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n};\nexport var uploadFile = function uploadFile(file, dirId) {\n  return /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch) {\n      var fileData;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return fileAPI.uploadFile(file, dirId, dispatch);\n\n            case 2:\n              fileData = _context3.sent;\n              dispatch(createFile(fileData));\n\n            case 4:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function (_x3) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n};\nexport var downloadFile = function downloadFile(file) {\n  return /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch) {\n      var fileBlob, fileDownloadUrl, link;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return fileAPI.downloadFile(file._id);\n\n            case 2:\n              fileBlob = _context4.sent;\n              fileDownloadUrl = window.URL.createObjectURL(fileBlob);\n              link = document.createElement('a');\n              document.body.appendChild(link);\n              link.href = fileDownloadUrl;\n              link.download = file.name;\n              link.click();\n              link.remove();\n\n            case 10:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function (_x4) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n};\nexport var deleteFile = function deleteFile(file) {\n  return /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch) {\n      var fileId;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.next = 2;\n              return fileAPI.deleteFile(file._id);\n\n            case 2:\n              fileId = _context5.sent;\n              dispatch(removeFile(fileId));\n\n            case 4:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function (_x5) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n}; // export const searchFiles = (searchString) => async (dispatch) => {\n//   const foundFiles = await fileAPI.searchFile(searchString);\n//   dispatch(setFiles(foundFiles));\n// };","map":{"version":3,"sources":["/Users/kkalwik/Desktop/test/fix-praca-inz/frontend/src/redux/file-reducer.js"],"names":["createSlice","fileAPI","fileReducer","name","initialState","files","currentDir","fileStack","mode","loading","reducers","setFiles","state","action","payload","setCurrentDir","createFile","push","removeFile","filter","file","_id","id","pushToFileStack","popFromFileStack","pop","setFileViewMode","toggleLoading","actions","reducer","loadFiles","dirId","sort","dispatch","getFiles","data","createNewDir","createDir","dir","uploadFile","fileData","downloadFile","fileBlob","fileDownloadUrl","window","URL","createObjectURL","link","document","createElement","body","appendChild","href","download","click","remove","deleteFile","fileId"],"mappings":"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","sourcesContent":["import { createSlice } from '@reduxjs/toolkit';\nimport { fileAPI } from '../api/file-api';\n\nconst fileReducer = createSlice({\n  name: 'files',\n  initialState: {\n    files: [],\n    currentDir: null,\n    fileStack: [],\n    mode: 'list',\n    loading: false,\n  },\n  reducers: {\n    setFiles(state, action) {\n      state.files = action.payload;\n    },\n    setCurrentDir(state, action) {\n      state.currentDir = action.payload;\n    },\n    createFile(state, action) {\n      state.files.push(action.payload);\n    },\n    removeFile(state, action) {\n      state.files = state.files.filter(file => file._id !== action.payload.id);\n    },\n    pushToFileStack(state, action) {\n      state.fileStack.push(action.payload);\n    },\n    popFromFileStack(state, action) {\n      state.fileStack.pop();\n    },\n\n    setFileViewMode(state, action) {\n      state.mode = action.payload;\n    },\n    toggleLoading(state, action) {\n      state.loading = action.payload;\n    },\n  },\n});\n\nexport const {\n  setFiles,\n  setCurrentDir,\n  createFile,\n  removeFile,\n  pushToFileStack,\n  popFromFileStack,\n  setFileViewMode,\n  toggleLoading,\n} = fileReducer.actions;\nexport default fileReducer.reducer;\n\nexport const loadFiles = (dirId, sort) => async dispatch => {\n  const data = await fileAPI.getFiles(dirId, sort);\n  dispatch(setFiles(data));\n};\n\nexport const createNewDir = (dirId, name) => async dispatch => {\n  const dir = await fileAPI.createDir(dirId, name);\n  dispatch(createFile(dir));\n};\n\nexport const uploadFile = (file, dirId) => async dispatch => {\n  const fileData = await fileAPI.uploadFile(file, dirId, dispatch);\n\n  dispatch(createFile(fileData));\n};\n\nexport const downloadFile = file => async dispatch => {\n  const fileBlob = await fileAPI.downloadFile(file._id);\n\n  const fileDownloadUrl = window.URL.createObjectURL(fileBlob);\n  const link = document.createElement('a');\n  document.body.appendChild(link);\n  link.href = fileDownloadUrl;\n  link.download = file.name;\n  link.click();\n  link.remove();\n};\n\nexport const deleteFile = file => async dispatch => {\n  const fileId = await fileAPI.deleteFile(file._id);\n\n  dispatch(removeFile(fileId));\n};\n\n// export const searchFiles = (searchString) => async (dispatch) => {\n//   const foundFiles = await fileAPI.searchFile(searchString);\n//   dispatch(setFiles(foundFiles));\n// };\n"]},"metadata":{},"sourceType":"module"}